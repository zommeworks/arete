{"ast":null,"code":"import _classCallCheck from\"/Users/zomme/Github/arete/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/zomme/Github/arete/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/zomme/Github/arete/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/zomme/Github/arete/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/zomme/Github/arete/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import Sound from'react-sound';//to install: npm install react-sound\nimport styles from'./App.css';import data from'./testscript.json';import $ from'jquery';/*\n  UI scheme\n\n ┏━━━━ baseplate ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n ┃                                                 ┃\n ┃  ┏━━━━ TTSComp ━━━━━━━━━━━━━━━━━━━━━━━┓         ┃\n ┃  ┃  state: url (string)               ┃         ┃\n ┃  ┃         name (string)              ┃         ┃\n ┃  ┃         maxTimeout (int)           ┃         ┃\n ┃  ┃         voiceInput (0/1)           ┃         ┃\n ┃  ┃         playStatus (Sound.Status)  ┃         ┃\n ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛         ┃\n ┃                                                 ┃\n ┃  ┏━━━━ BoxAgent ━━━━━━━━━━━━━━━━━━━━━━━━━━┓     ┃\n ┃  ┃  ┏━━━━ ButtonAgent ━━━━━━━━━━━━━━━━━┓  ┃     ┃\n ┃  ┃  ┃  state: voiceInput (0/1)         ┃  ┃     ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃     ┃\n ┃  ┃  ┏━━━━ TextSubtitle ━━━━━━━━━━━━━━━━┓  ┃     ┃\n ┃  ┃  ┃  state: theme (light / dark)     ┃  ┃     ┃\n ┃  ┃  ┃         displayMessage (string)  ┃  ┃     ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃     ┃\n ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛     ┃\n ┃                                                 ┃\n ┃  ┏━━━━ BoxImage ━━━━━━━━━━━━━━━━━━━━━━━━━━┓     ┃\n ┃  ┃  (props:hasImage)                      ┃     ┃\n ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛     ┃\n ┃                                                 ┃\n ┃  ┏━━━━ BoxController ━━━━━━━━━━━━━━━━━━━━━━━━┓  ┃\n ┃  ┃  state: theme (light / dark)              ┃  ┃\n ┃  ┃         voiceInput (0/1)                  ┃  ┃\n ┃  ┃  ┏━━━━ div.box-bar ━━━━━━━━━━━━━━━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ ProgressBar ━━━━━━━━━━━━━━┓  ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: voiceInput (0/1)      ┃  ┃  ┃  ┃\n ┃  ┃  ┃  ┃         maxTimeout (int)      ┃  ┃  ┃  ┃\n ┃  ┃  ┃  ┃         elapsedTime (int)     ┃  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ div.bar-base ━━━━━━━━━━━━━┓  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃  ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┏━━━━ div.box-buttons ━━━━━━━━━━━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnRewind ━━━━━━┓  ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnPlayPause ━━━┓  ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃  ┃\n ┃  ┃  ┃  ┃         voiceInput (0/1)      ┃  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnSkip ━━━━━━━━┓  ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnExit ━━━━━━━━┓  ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃  ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃\n ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛\n\n**/ /* * * * * * * * * * *\n * global variables  *\n * * * * * * * * * * */var currentData={};var nextDataName='';//functions\nfunction initData(){try{var docID=getUrlParams().name;$.each(data.list,function(i){if(data.list[i].name===docID){overwriteData(data.list[i],currentData);}});}catch(e){alert('failed to load data');}nextDataName=getnextDataName();}function initNext(){$.each(data.list,function(i){if(data.list[i].name===nextDataName){overwriteData(data.list[i],currentData);}});nextDataName=getnextDataName();}function getnextDataName(){var j;for(var i=0;i<data.list.length;i++){if(data.list[i].name===currentData.name){j=i+1;break;}}for(j;j<data.list.length;j++){if(data.list[j].name.match(/(prompt|statement)/)){return data.list[j].name;break;}}}function getUrlParams(){var params={};window.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(str,key,value){params[key]=value;});return params;}function overwriteData(source,target){target.name=source.name;target.message=source.message;target.displayMessage=source.displayMessage;target.displayOnly=source.displayOnly;target.hasImage=source.hasImage;target.epd=source.epd;target.answerEntity=source.answerEntity;target.maxTimeout=source.maxTimeout;}var Baseplate=/*#__PURE__*/function(_React$Component){_inherits(Baseplate,_React$Component);var _super=_createSuper(Baseplate);function Baseplate(props){var _this;_classCallCheck(this,Baseplate);_this=_super.call(this,props);_this.state={name:'',message:'',displayMessage:'',displayOnly:0,hasImage:0,epd:0,answerEntity:'',maxTimeout:0,voiceInput:0,elapsedTime:0,theme:'light',playStatus:Sound.status.STOPPED};_this.voiceInputHandler=_this.voiceInputHandler.bind(_assertThisInitialized(_this));_this.updateState=_this.updateState.bind(_assertThisInitialized(_this));_this.playSound=_this.playSound.bind(_assertThisInitialized(_this));return _this;}_createClass(Baseplate,[{key:\"updateState\",value:function updateState(){window.location.href='?name='+nextDataName;//\ninitNext();this.setState({name:currentData.name,message:currentData.message,displayMessage:currentData.displayMessage,displayOnly:currentData.displayOnly,hasImage:currentData.hasImage,epd:currentData.epd,answerEntity:currentData.answerEntity,maxTimeout:currentData.maxTimeout,voiceInput:0,elapsedTime:0,playStatus:Sound.status.STOPPED});console.log('redirected to next script: '+window.location);}},{key:\"stopAndSkip\",value:function stopAndSkip(){var _this2=this;this.setState({theme:'light',voiceInput:0});setTimeout(function(){clearInterval(_this2.timeoutCounter);_this2.updateState();},500);//\n}},{key:\"playSound\",value:function playSound(){this.setState({playStatus:Sound.status.PLAYING});}},{key:\"voiceInputHandler\",value:function voiceInputHandler(){var _this3=this;//getting user turn\nif(currentData.name.match(/(prompt|feedback)/)){if(this.state.voiceInput===0){this.setState({theme:'dark',voiceInput:1,playStatus:Sound.status.STOPPED});//start timeout counter\nvar limit=this.state.maxTimeout*1000;var frequency=100;var elapsedTime=0;this.timeoutCounter=setInterval(function(){if(elapsedTime<limit){elapsedTime+=frequency;_this3.setState({elapsedTime:elapsedTime/1000});console.log('listening: ',elapsedTime/1000);}else{_this3.stopAndSkip();}},frequency);}}//pass to next target\nelse if(currentData.name.match(/statement/)){this.updateState();}}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{id:\"baseplate\"},/*#__PURE__*/React.createElement(TTSComp,{name:this.state.name,maxTimeout:this.state.maxTimeout,voiceInput:this.state.voiceInput,voiceInputHandler:this.voiceInputHandler,playStatus:this.state.playStatus,playSound:this.playSound}),/*#__PURE__*/React.createElement(BoxAgent,{voiceInput:this.state.voiceInput,theme:this.state.theme,displayMessage:this.state.displayMessage,voiceInputHandler:this.voiceInputHandler}),/*#__PURE__*/React.createElement(BoxImage,{name:this.state.name,hasImage:this.state.hasImage,theme:this.state.theme}),/*#__PURE__*/React.createElement(BoxController,{theme:this.state.theme,maxTimeout:this.state.maxTimeout,voiceInput:this.state.voiceInput,elapsedTime:this.state.elapsedTime,voiceInputHandler:this.voiceInputHandler}));}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){return{name:props.name,message:props.message,displayMessage:props.displayMessage,displayOnly:props.displayOnly,hasImage:props.hasImage,epd:props.epd,answerEntity:props.answerEntity,maxTimeout:props.maxTimeout};}}]);return Baseplate;}(React.Component);var TTSComp=/*#__PURE__*/function(_React$Component2){_inherits(TTSComp,_React$Component2);var _super2=_createSuper(TTSComp);function TTSComp(props){var _this4;_classCallCheck(this,TTSComp);_this4=_super2.call(this,props);_this4.state={voiceInput:0,playStatus:Sound.status.STOPPED};return _this4;}_createClass(TTSComp,[{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(Sound,{url:this.state.url,autoLoad:true,onLoad:this.props.playSound,playStatus:this.state.playStatus,onFinishedPlaying:this.props.voiceInputHandler});}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){return{url:'tts/'+props.name+'.mp3',name:props.name,maxTimeout:props.maxTimeout,voiceInput:props.voiceInput,playStatus:props.playStatus};}}]);return TTSComp;}(React.Component);/* * * * * * * * * * * * *\n * BoxAgent and children *\n * * * * * * * * * * * * */var BoxAgent=/*#__PURE__*/function(_React$Component3){_inherits(BoxAgent,_React$Component3);var _super3=_createSuper(BoxAgent);function BoxAgent(props){var _this5;_classCallCheck(this,BoxAgent);_this5=_super3.call(this,props);_this5.state={voiceInput:0,theme:'light',displayMessage:\"dummy text\"};return _this5;}_createClass(BoxAgent,[{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{className:\"box-agent\"},/*#__PURE__*/React.createElement(ButtonAgent,{voiceInput:this.state.voiceInput,voiceInputHandler:this.props.voiceInputHandler}),/*#__PURE__*/React.createElement(TextSubtitle,{theme:this.state.theme,displayMessage:this.state.displayMessage}));}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){return{voiceInput:props.voiceInput,theme:props.theme,displayMessage:props.displayMessage};}}]);return BoxAgent;}(React.Component);var ButtonAgent=/*#__PURE__*/function(_React$Component4){_inherits(ButtonAgent,_React$Component4);var _super4=_createSuper(ButtonAgent);function ButtonAgent(props){var _this6;_classCallCheck(this,ButtonAgent);_this6=_super4.call(this,props);_this6.setButtonStatus=function(param){switch(param){case 0:return'idle';case 1:return'listening';default:return'idle';}};_this6.state={voiceInput:0};return _this6;}_createClass(ButtonAgent,[{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"button\",{id:\"btnAgent\",className:\"button-agent status-\"+this.setButtonStatus(this.state.voiceInput),onClick:this.props.voiceInputHandler});}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){return{voiceInput:props.voiceInput};}}]);return ButtonAgent;}(React.Component);var TextSubtitle=/*#__PURE__*/function(_React$Component5){_inherits(TextSubtitle,_React$Component5);var _super5=_createSuper(TextSubtitle);function TextSubtitle(props){var _this7;_classCallCheck(this,TextSubtitle);_this7=_super5.call(this,props);_this7.state={theme:'light',displayMessage:'dummy text'};return _this7;}_createClass(TextSubtitle,[{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"p\",{id:\"txtSubtitle\",className:\"theme-\"+this.state.theme},this.state.displayMessage);}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){return{theme:props.theme,displayMessage:props.displayMessage};}}]);return TextSubtitle;}(React.Component);/* * * * * * * * * * * * * * * *\n * Image If needed  *\n * * * * * * * * * * * * * * * */var BoxImage=/*#__PURE__*/function(_React$Component6){_inherits(BoxImage,_React$Component6);var _super6=_createSuper(BoxImage);function BoxImage(props){var _this8;_classCallCheck(this,BoxImage);_this8=_super6.call(this,props);_this8.onError=function(){_this8.setState({name:'none'});};_this8.state={theme:'light'};return _this8;}_createClass(BoxImage,[{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{className:'box-image'},/*#__PURE__*/React.createElement(\"img\",{className:'image theme-'+this.state.theme,src:'./img/'+this.state.name+'.png'//src={'./img/TASK_J2_03_prompt_1.png'}\n,onError:this.onError,alt:''}));}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){return{theme:props.theme,name:props.name};}}]);return BoxImage;}(React.Component);/* * * * * * * * * * * * * * * *\n * BoxController and children  *\n * * * * * * * * * * * * * * * */var BoxController=/*#__PURE__*/function(_React$Component7){_inherits(BoxController,_React$Component7);var _super7=_createSuper(BoxController);function BoxController(props){var _this9;_classCallCheck(this,BoxController);_this9=_super7.call(this,props);_this9.setTheme=function(){_this9.setState({theme:_this9.state.theme==='light'?'dark':'light'});};_this9.state={theme:'light'};return _this9;}_createClass(BoxController,[{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{className:\"box-controller\"},/*#__PURE__*/React.createElement(\"div\",{className:\"box-bar\"},/*#__PURE__*/React.createElement(ProgressBar,{voiceInput:this.state.voiceInput,elapsedTime:this.props.elapsedTime,maxTimeout:this.props.maxTimeout}),/*#__PURE__*/React.createElement(\"div\",{className:\"bar bar-base theme-\"+this.state.theme,onClick:this.setTheme})),/*#__PURE__*/React.createElement(\"div\",{className:\"box-buttons\"},/*#__PURE__*/React.createElement(ButtonSmall,{name:\"btnRewind\",alignRight:false,theme:this.state.theme}),/*#__PURE__*/React.createElement(ButtonSmall,{name:\"btnSkip\",alignRight:false,theme:this.state.theme}),/*#__PURE__*/React.createElement(ButtonSmall,{name:\"btnExit\",alignRight:true,theme:this.state.theme})));}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){return{theme:props.theme};}}]);return BoxController;}(React.Component);var ProgressBar=/*#__PURE__*/function(_React$Component8){_inherits(ProgressBar,_React$Component8);var _super8=_createSuper(ProgressBar);function ProgressBar(props){var _this10;_classCallCheck(this,ProgressBar);_this10=_super8.call(this,props);_this10.getWidth=function(){var limit=_this10.props.maxTimeout;var percentage=_this10.state.elapsedTime/limit*100+'%';return percentage;};_this10.state={voiceInput:0};return _this10;}_createClass(ProgressBar,[{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{className:\"bar bar-progress\",style:{width:this.getWidth()}});}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){return{voiceInput:props.voiceInput,elapsedTime:props.elapsedTime};}}]);return ProgressBar;}(React.Component);var ButtonSmall=/*#__PURE__*/function(_React$Component9){_inherits(ButtonSmall,_React$Component9);var _super9=_createSuper(ButtonSmall);function ButtonSmall(props){var _this11;_classCallCheck(this,ButtonSmall);_this11=_super9.call(this,props);_this11.state={theme:'light',clicked:false};return _this11;}_createClass(ButtonSmall,[{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"button\",{id:this.props.name,className:\"button-small theme-\"+this.state.theme+(this.props.alignRight?' align-right':'')});}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){return{theme:props.theme,clicked:props.clicked};}}]);return ButtonSmall;}(React.Component);function App(){initData();var element=/*#__PURE__*/React.createElement(Baseplate,{name:currentData.name,message:currentData.message,displayMessage:currentData.displayMessage,displayOnly:currentData.displayOnly,hasImage:currentData.hasImage,epd:currentData.epd,answerEntity:currentData.answerEntity,maxTimeout:currentData.maxTimeout});return element;}export default App;","map":{"version":3,"sources":["/Users/zomme/Github/arete/src/App.js"],"names":["React","Sound","styles","data","$","currentData","nextDataName","initData","docID","getUrlParams","name","each","list","i","overwriteData","e","alert","getnextDataName","initNext","j","length","match","params","window","location","search","replace","str","key","value","source","target","message","displayMessage","displayOnly","hasImage","epd","answerEntity","maxTimeout","Baseplate","props","state","voiceInput","elapsedTime","theme","playStatus","status","STOPPED","voiceInputHandler","bind","updateState","playSound","href","setState","console","log","setTimeout","clearInterval","timeoutCounter","PLAYING","limit","frequency","setInterval","stopAndSkip","Component","TTSComp","url","BoxAgent","ButtonAgent","setButtonStatus","param","TextSubtitle","BoxImage","onError","BoxController","setTheme","ProgressBar","getWidth","percentage","width","ButtonSmall","clicked","alignRight","App","element"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Sound from 'react-sound'; //to install: npm install react-sound\nimport styles from './App.css';\nimport data from './testscript.json'\nimport $ from 'jquery';\n\n\n/*\n  UI scheme\n\n ┏━━━━ baseplate ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n ┃                                                 ┃\n ┃  ┏━━━━ TTSComp ━━━━━━━━━━━━━━━━━━━━━━━┓         ┃\n ┃  ┃  state: url (string)               ┃         ┃\n ┃  ┃         name (string)              ┃         ┃\n ┃  ┃         maxTimeout (int)           ┃         ┃\n ┃  ┃         voiceInput (0/1)           ┃         ┃\n ┃  ┃         playStatus (Sound.Status)  ┃         ┃\n ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛         ┃\n ┃                                                 ┃\n ┃  ┏━━━━ BoxAgent ━━━━━━━━━━━━━━━━━━━━━━━━━━┓     ┃\n ┃  ┃  ┏━━━━ ButtonAgent ━━━━━━━━━━━━━━━━━┓  ┃     ┃\n ┃  ┃  ┃  state: voiceInput (0/1)         ┃  ┃     ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃     ┃\n ┃  ┃  ┏━━━━ TextSubtitle ━━━━━━━━━━━━━━━━┓  ┃     ┃\n ┃  ┃  ┃  state: theme (light / dark)     ┃  ┃     ┃\n ┃  ┃  ┃         displayMessage (string)  ┃  ┃     ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃     ┃\n ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛     ┃\n ┃                                                 ┃\n ┃  ┏━━━━ BoxImage ━━━━━━━━━━━━━━━━━━━━━━━━━━┓     ┃\n ┃  ┃  (props:hasImage)                      ┃     ┃\n ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛     ┃\n ┃                                                 ┃\n ┃  ┏━━━━ BoxController ━━━━━━━━━━━━━━━━━━━━━━━━┓  ┃\n ┃  ┃  state: theme (light / dark)              ┃  ┃\n ┃  ┃         voiceInput (0/1)                  ┃  ┃\n ┃  ┃  ┏━━━━ div.box-bar ━━━━━━━━━━━━━━━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ ProgressBar ━━━━━━━━━━━━━━┓  ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: voiceInput (0/1)      ┃  ┃  ┃  ┃\n ┃  ┃  ┃  ┃         maxTimeout (int)      ┃  ┃  ┃  ┃\n ┃  ┃  ┃  ┃         elapsedTime (int)     ┃  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ div.bar-base ━━━━━━━━━━━━━┓  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃  ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┏━━━━ div.box-buttons ━━━━━━━━━━━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnRewind ━━━━━━┓  ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnPlayPause ━━━┓  ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃  ┃\n ┃  ┃  ┃  ┃         voiceInput (0/1)      ┃  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnSkip ━━━━━━━━┓  ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnExit ━━━━━━━━┓  ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃  ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃\n ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛\n\n**/\n\n\n\n/* * * * * * * * * * *\n * global variables  *\n * * * * * * * * * * */\n\nvar currentData = {};\nvar nextDataName = '';\n\n\n\n//functions\n\nfunction initData(){\n  try {\n    let docID = getUrlParams().name;\n    $.each(data.list, function(i){\n      if(data.list[i].name === docID){\n        overwriteData(data.list[i], currentData);\n      }\n    });\n  }\n  catch(e) {\n    alert('failed to load data');\n  }\n  nextDataName = getnextDataName();\n}\n\nfunction initNext() {\n  $.each(data.list, function(i){\n    if(data.list[i].name === nextDataName){\n      overwriteData(data.list[i], currentData);\n    }\n  });\n  nextDataName = getnextDataName();\n}\n\nfunction getnextDataName() {\n  let j;\n  for(let i = 0; i < data.list.length; i++){\n    if(data.list[i].name === currentData.name){\n      j = i+1;\n      break;\n    }\n  }\n  for(j; j < data.list.length; j++){\n    if(data.list[j].name.match(/(prompt|statement)/)) {\n      return data.list[j].name;\n      break;\n    }\n  }\n}\n\nfunction getUrlParams() {\n    var params = {};\n    window.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(str, key, value) { params[key] = value; });\n    return params;\n}\n\nfunction overwriteData(source, target) {\n  target.name = source.name;\n  target.message = source.message;\n  target.displayMessage = source.displayMessage;\n  target.displayOnly = source.displayOnly;\n  target.hasImage = source.hasImage;\n  target.epd = source.epd;\n  target.answerEntity = source.answerEntity;\n  target.maxTimeout = source.maxTimeout;\n}\n\nclass Baseplate extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      name: '',\n      message: '',\n      displayMessage: '',\n      displayOnly: 0,\n      hasImage: 0,\n      epd: 0,\n      answerEntity: '',\n      maxTimeout: 0,\n      voiceInput: 0,\n      elapsedTime: 0,\n      theme: 'light',\n      playStatus: Sound.status.STOPPED\n    }\n    this.voiceInputHandler = this.voiceInputHandler.bind(this);\n    this.updateState = this.updateState.bind(this);\n    this.playSound = this.playSound.bind(this);\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      name: props.name,\n      message: props.message,\n      displayMessage: props.displayMessage,\n      displayOnly: props.displayOnly,\n      hasImage: props.hasImage,\n      epd: props.epd,\n      answerEntity: props.answerEntity,\n      maxTimeout: props.maxTimeout,\n    };\n  }\n  updateState() {\n    window.location.href = '?name=' + nextDataName;//\n    initNext();\n    this.setState({\n      name: currentData.name,\n      message: currentData.message,\n      displayMessage: currentData.displayMessage,\n      displayOnly: currentData.displayOnly,\n      hasImage: currentData.hasImage,\n      epd: currentData.epd,\n      answerEntity: currentData.answerEntity,\n      maxTimeout: currentData.maxTimeout,\n      voiceInput: 0,\n      elapsedTime: 0,\n      playStatus: Sound.status.STOPPED,\n    });\n    console.log('redirected to next script: '+window.location);\n  }\n  stopAndSkip() {\n    this.setState({\n      theme: 'light',\n      voiceInput: 0,\n    });\n    setTimeout(() => {\n      clearInterval(this.timeoutCounter);\n      this.updateState();\n    }, 500);//\n  }\n  playSound() {\n    this.setState({\n      playStatus: Sound.status.PLAYING\n    });\n  }\n  voiceInputHandler() {\n    //getting user turn\n    if(currentData.name.match(/(prompt|feedback)/)) {\n      if(this.state.voiceInput === 0) {\n        this.setState({\n          theme: 'dark',\n          voiceInput: 1,\n          playStatus: Sound.status.STOPPED\n        });\n        //start timeout counter\n        const limit = this.state.maxTimeout * 1000;\n        const frequency = 100;\n        var elapsedTime = 0;\n        this.timeoutCounter = setInterval(() => {\n          if(elapsedTime < limit) {\n            elapsedTime += frequency;\n            this.setState({ elapsedTime: elapsedTime/1000 });\n            console.log('listening: ',elapsedTime/1000);\n          }\n          else {\n            this.stopAndSkip();\n          }\n        }, frequency);\n      }\n    }\n    //pass to next target\n    else if(currentData.name.match(/statement/)) {\n      this.updateState();\n    }\n  }\n  render() {\n    return(\n      <div id=\"baseplate\">\n        <TTSComp\n          name={this.state.name}\n          maxTimeout={this.state.maxTimeout}\n          voiceInput={this.state.voiceInput}\n          voiceInputHandler={this.voiceInputHandler}\n          playStatus={this.state.playStatus}\n          playSound={this.playSound}\n        />\n        <BoxAgent\n          voiceInput={this.state.voiceInput}\n          theme={this.state.theme}\n          displayMessage={this.state.displayMessage}\n          voiceInputHandler={this.voiceInputHandler}\n        />\n        <BoxImage\n          name={this.state.name}\n          hasImage={this.state.hasImage}\n          theme={this.state.theme}\n        />\n        <BoxController\n          theme={this.state.theme}\n          maxTimeout={this.state.maxTimeout}\n          voiceInput={this.state.voiceInput}\n          elapsedTime={this.state.elapsedTime}\n          voiceInputHandler={this.voiceInputHandler}\n        />\n      </div>\n    );\n  }\n}\n\nclass TTSComp extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      voiceInput: 0,\n      playStatus: Sound.status.STOPPED,\n    }\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      url: 'tts/'+props.name+'.mp3',\n      name: props.name,\n      maxTimeout: props.maxTimeout,\n      voiceInput: props.voiceInput,\n      playStatus: props.playStatus,\n    };\n  }\n  render() {\n    return(\n      <Sound\n        url={this.state.url}\n        autoLoad={true}\n        onLoad={this.props.playSound}\n        playStatus={this.state.playStatus}\n        onFinishedPlaying={this.props.voiceInputHandler}\n      />\n    );\n  }\n}\n\n\n\n/* * * * * * * * * * * * *\n * BoxAgent and children *\n * * * * * * * * * * * * */\n\nclass BoxAgent extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      voiceInput: 0,\n      theme: 'light',\n      displayMessage: \"dummy text\"\n    };\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      voiceInput: props.voiceInput,\n      theme: props.theme,\n      displayMessage: props.displayMessage\n    };\n  }\n  render() {\n    return(\n      <div className=\"box-agent\">\n        <ButtonAgent\n          voiceInput={this.state.voiceInput}\n          voiceInputHandler={this.props.voiceInputHandler}\n        />\n        <TextSubtitle theme={this.state.theme} displayMessage={this.state.displayMessage}/>\n      </div>\n    );\n  }\n}\n\nclass ButtonAgent extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      voiceInput: 0,\n    };\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      voiceInput: props.voiceInput\n    };\n  }\n  setButtonStatus = (param) => {\n    switch(param) {\n      case 0:\n        return 'idle';\n      case 1:\n        return 'listening';\n      default:\n        return 'idle';\n    }\n  }\n  render() {\n    return(\n      <button\n        id=\"btnAgent\"\n        className={\"button-agent status-\"+this.setButtonStatus(this.state.voiceInput)}\n        onClick={this.props.voiceInputHandler}\n      >\n      </button>\n    );\n  }\n}\n\nclass TextSubtitle extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      theme: 'light',\n      displayMessage: 'dummy text'\n    };\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      theme: props.theme,\n      displayMessage: props.displayMessage\n    };\n  }\n  render() {\n    return(\n      <p\n        id=\"txtSubtitle\"\n        className={\"theme-\"+this.state.theme}\n      >\n        {this.state.displayMessage}\n      </p>\n    );\n  }\n}\n\n\n\n\n/* * * * * * * * * * * * * * * *\n * Image If needed  *\n * * * * * * * * * * * * * * * */\n\nclass BoxImage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      theme: 'light',\n    }\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      theme: props.theme,\n      name: props.name,\n    };\n  }\n  onError = () => {\n    this.setState({\n      name: 'none',\n    });\n  }\n  render() {\n    return(\n      <div className={'box-image'}>\n        <img\n          className={'image theme-'+this.state.theme}\n          src={'./img/'+this.state.name+'.png'}\n          //src={'./img/TASK_J2_03_prompt_1.png'}\n          onError={this.onError}\n          alt={''}\n        ></img>\n      </div>\n    );\n  }\n}\n\n\n\n/* * * * * * * * * * * * * * * *\n * BoxController and children  *\n * * * * * * * * * * * * * * * */\n\nclass BoxController extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      theme: 'light'\n    };\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      theme: props.theme\n    };\n  }\n  setTheme = () => {\n    this.setState({ theme: this.state.theme === 'light' ? 'dark' : 'light' });\n  }\n  render() {\n    return(\n      <div className=\"box-controller\">\n        <div className=\"box-bar\">\n          <ProgressBar\n            voiceInput={this.state.voiceInput}\n            elapsedTime={this.props.elapsedTime}\n            maxTimeout={this.props.maxTimeout}\n          />\n          <div className={\"bar bar-base theme-\"+this.state.theme}\n          onClick={this.setTheme}></div>\n        </div>\n        <div className=\"box-buttons\">\n          <ButtonSmall\n            name=\"btnRewind\"\n            alignRight={false}\n            theme={this.state.theme}\n          />\n          <ButtonSmall name=\"btnSkip\" alignRight={false} theme={this.state.theme} />\n          <ButtonSmall name=\"btnExit\" alignRight={true} theme={this.state.theme} />\n        </div>\n      </div>\n    );\n  }\n}\nclass ProgressBar extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      voiceInput: 0\n    }\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      voiceInput: props.voiceInput,\n      elapsedTime: props.elapsedTime,\n    };\n  }\n  getWidth = () => {\n    let limit = this.props.maxTimeout;\n    let percentage = (this.state.elapsedTime / limit) * 100 + '%';\n    return percentage;\n  }\n  render() {\n    return (\n      <div\n        className={\"bar bar-progress\"}\n        style={{width: this.getWidth()}}\n      ></div>\n    );\n  }\n}\nclass ButtonSmall extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      theme: 'light',\n      clicked: false\n    }\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      theme: props.theme,\n      clicked: props.clicked\n    };\n  }\n  render() {\n    return (\n      <button\n        id={this.props.name}\n        className={\n          \"button-small theme-\"+\n          this.state.theme+\n          (this.props.alignRight ? ' align-right' : '')\n        }\n      >\n      </button>\n    );\n  }\n}\n\n\nfunction App() {\n  initData();\n  const element =\n    <Baseplate\n      name={currentData.name}\n      message={currentData.message}\n      displayMessage={currentData.displayMessage}\n      displayOnly={currentData.displayOnly}\n      hasImage={currentData.hasImage}\n      epd={currentData.epd}\n      answerEntity={currentData.answerEntity}\n      maxTimeout={currentData.maxTimeout}\n    />;\n  return(element);\n}\nexport default App;\n"]},"metadata":{},"sourceType":"module"}