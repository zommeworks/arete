{"ast":null,"code":"import _classCallCheck from\"/Users/zomme/Github/arete/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/zomme/Github/arete/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/zomme/Github/arete/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _createSuper from\"/Users/zomme/Github/arete/node_modules/@babel/runtime/helpers/esm/createSuper\";import _inherits from\"/Users/zomme/Github/arete/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import styles from'./App.css';import data from'./testscript.json';import $ from'jquery';/*\n  UI scheme\n\n ┏━━━━ baseplate ━━━━┓\n ┃  ┏━━━━ AudioController ━━━━┓\n ┃  ┃\n ┃  ┗━━━━━━━━┛  ┃\n ┃  ┏━━━━ BoxAgent ━━━━━━━━━━━━━━━━━━━━━┓\n ┃  ┃  ┏━━━━ ButtonAgent ━━━━━━━━━━━━┓  ┃\n ┃  ┃  ┃  props: playStatus (0/1/2)  ┃  ┃\n ┃  ┃  ┃  state: playStatus (0/1/2)  ┃  ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃\n ┃  ┃  ┏━━━━ TextSubtitle ━━━━━━━━━━━┓  ┃\n ┃  ┃  ┃  props: text (string)       ┃  ┃\n ┃  ┃  ┃         playStatus (0/1/2)  ┃  ┃\n ┃  ┃  ┃  state: playStatus (0/1/2)  ┃  ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃\n ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛\n ┃\n ┃  ┏━━━━ BoxController ━━━━━━━━━━━━━━━━━━━━━━━━┓\n ┃  ┃  props: theme (light / dark)              ┃\n ┃  ┃         playStatus (0/1/2)                ┃\n ┃  ┃  state: theme (light / dark)              ┃\n ┃  ┃         playStatus (0/1/2)                ┃\n ┃  ┃  ┏━━━━ div.box-bar ━━━━━━━━━━━━━━━━━━━━┓  ┃\n ┃  ┃  ┃  ┏━━━━ ProgressBar ━━━━━━━━━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┃  props: playStatus (0/1/2)    ┃  ┃  ┃\n ┃  ┃  ┃  ┃         maxTimeout (int)      ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: playStatus (0/1/2)    ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ div.bar-base ━━━━━━━━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃\n ┃  ┃  ┏━━━━ div.box-buttons ━━━━━━━━━━━━━━━━┓  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnRewind ━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┃  props: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnPlayPause ━━━┓  ┃  ┃\n ┃  ┃  ┃  ┃  props: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┃         playStatus (0/1/2)    ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┃         playStatus (0/1/2)    ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnSkip ━━━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┃  props: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnExit ━━━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┃  props: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃\n ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛\n ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛\n\n\n props and states\n\n playStatus:\n  0: null,\n  1: audio ready,\n  2: playing,\n  3: audio end\n**/ /* * * * * * * * * * *\n * global variables  *\n * * * * * * * * * * */var currentData={};var nextData={};var ttsBuffer=null;// webAudioAPI Fix up prefixing\nwindow.AudioContext=window.AudioContext||window.webkitAudioContext;var context=new AudioContext();/* * * * * * * * * * * * *\n * webAudioAPI functions *\n * * * * * * * * * * * * */function initAudio(){try{// Fix up for prefixing\nwindow.AudioContext=window.AudioContext||window.webkitAudioContext;context=new AudioContext();}catch(e){alert('Web Audio API is not supported in this browser');}}function loadTTS(filename){var request=new XMLHttpRequest();var url='../src/tts/'+filename+'.mp3';request.open('GET',url,true);request.responseType='arraybuffer';// Decode asynchronously\nrequest.onload=function(){context.decodeAudioData(request.response,function(buffer){ttsBuffer=buffer;},onError);};request.send();}function onError(e){console.log(\"error loading an audio file.\",e);}function playSound(buffer){var source=context.createBufferSource();// creates a sound source\nsource.buffer=buffer;// tell the source which sound to play\nsource.connect(context.destination);// connect the source to the context's destination (the speakers)\nsource.start(0);// play the source now\n// note: on older systems, may have to use deprecated noteOn(time);\n}/* execution */ //functions\nfunction initData(){try{var docID=window.location.hash.split('#');$.each(data.list,function(i){if(data.list[i].name===docID[1]){overwriteData(data.list[i],currentData);if(data.list[i].name.match(/(prompt|statement)/)){}}});}catch(e){alert('failed to load data');}loadTTS(currentData.name);}function overwriteData(source,target){target.name=source.name;target.message=source.message;target.displayMessage=source.displayMessage;target.displayOnly=source.displayOnly;target.hasImage=source.hasImage;target.epd=source.epd;target.answerEntity=source.answerEntity;target.maxTimeout=source.maxTimeout;//target.duration = source.duration;\n}var Baseplate=/*#__PURE__*/function(_React$Component){_inherits(Baseplate,_React$Component);var _super=_createSuper(Baseplate);function Baseplate(props){var _this;_classCallCheck(this,Baseplate);_this=_super.call(this,props);_this.state={name:'',message:'',displayMessage:'',displayOnly:0,hasImage:0,epd:0,answerEntity:'',maxTimeout:0,duration:0,currentPlayTime:0,playStatus:0,theme:'light'};_this.handler=_this.handler.bind(_assertThisInitialized(_this));return _this;}_createClass(Baseplate,[{key:\"handler\",value:function handler(){if(this.state.playStatus===2){this.setState({playStatus:3,theme:'light'});}else{this.setState({playStatus:2,theme:'dark'});}}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{id:\"baseplate\"},/*#__PURE__*/React.createElement(BoxAgent,{playStatus:this.state.playStatus,theme:this.state.theme,displayMessage:this.state.displayMessage,handler:this.handler}),/*#__PURE__*/React.createElement(BoxController,{theme:this.state.theme,handler:this.handler}));}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){return{name:props.name,message:props.message,displayMessage:props.displayMessage,displayOnly:props.displayOnly,hasImage:props.hasImage,epd:props.epd,answerEntity:props.answerEntity,maxTimeout:props.maxTimeout};}}]);return Baseplate;}(React.Component);/* * * * * * * * * * * * *\n * BoxAgent and children *\n * * * * * * * * * * * * */var BoxAgent=/*#__PURE__*/function(_React$Component2){_inherits(BoxAgent,_React$Component2);var _super2=_createSuper(BoxAgent);function BoxAgent(props){var _this2;_classCallCheck(this,BoxAgent);_this2=_super2.call(this,props);_this2.state={playStatus:0,theme:'light',displayMessage:\"dummy text\"};return _this2;}_createClass(BoxAgent,[{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{className:\"box-agent\"},/*#__PURE__*/React.createElement(ButtonAgent,{playStatus:this.state.playStatus,handler:this.props.handler}),/*#__PURE__*/React.createElement(TextSubtitle,{theme:this.state.theme,displayMessage:this.state.displayMessage}));}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){return{playStatus:props.playStatus,theme:props.theme,displayMessage:props.displayMessage};}}]);return BoxAgent;}(React.Component);var ButtonAgent=/*#__PURE__*/function(_React$Component3){_inherits(ButtonAgent,_React$Component3);var _super3=_createSuper(ButtonAgent);function ButtonAgent(props){var _this3;_classCallCheck(this,ButtonAgent);_this3=_super3.call(this,props);_this3.setButtonStatus=function(param){switch(param){case 0://audio is not loaded\nreturn'idle';case 1://audio is ready\nreturn'idle';case 2://audio is playing\nreturn'listening';case 3://audio ended\nreturn'idle';default:return'idle';}};_this3.state={playStatus:0};return _this3;}_createClass(ButtonAgent,[{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"button\",{id:\"btnAgent\",className:\"button-agent status-\"+this.setButtonStatus(this.state.playStatus),onClick:this.props.handler});}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){return{playStatus:props.playStatus};}}]);return ButtonAgent;}(React.Component);var TextSubtitle=/*#__PURE__*/function(_React$Component4){_inherits(TextSubtitle,_React$Component4);var _super4=_createSuper(TextSubtitle);function TextSubtitle(props){var _this4;_classCallCheck(this,TextSubtitle);_this4=_super4.call(this,props);_this4.state={theme:'light',displayMessage:'dummy text'};return _this4;}_createClass(TextSubtitle,[{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"p\",{id:\"txtSubtitle\",className:\"theme-\"+this.state.theme},this.state.displayMessage);}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){return{theme:props.theme,displayMessage:props.displayMessage};}}]);return TextSubtitle;}(React.Component);/*\nclass AudioController extends React.Component {\n\n}\nclass AudioComp extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      name: props.name,\n      message: props.message,\n      displayMessage: props.displayMessage,\n      displayOnly: props.displayOnly,\n      hasImage: props.hasImage,\n      epd: props.epd,\n      answerEntity: props.answerEntity,\n      maxTimeout: props.maxTimeout,\n      duration: props.duration,\n      currentPlayTime: props.currentPlayTime,\n      playStatus: props.playStatus,\n      theme: props.theme\n    };\n  }\n  render() {\n    return(\n\n    );\n  }\n}\n*/ /* * * * * * * * * * * * * * * *\n * BoxController and children  *\n * * * * * * * * * * * * * * * */var BoxController=/*#__PURE__*/function(_React$Component5){_inherits(BoxController,_React$Component5);var _super5=_createSuper(BoxController);function BoxController(props){var _this5;_classCallCheck(this,BoxController);_this5=_super5.call(this,props);_this5.setTheme=function(){_this5.setState({theme:_this5.state.theme==='light'?'dark':'light'});};_this5.state={theme:'light'};return _this5;}_createClass(BoxController,[{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{className:\"box-controller\"},/*#__PURE__*/React.createElement(\"div\",{className:\"box-bar\"},/*#__PURE__*/React.createElement(\"div\",{className:\"bar bar-base theme-\"+this.state.theme,onClick:this.setTheme})),/*#__PURE__*/React.createElement(\"div\",{className:\"box-buttons\"},/*#__PURE__*/React.createElement(ButtonSmall,{name:\"btnRewind\",alignRight:false,theme:this.state.theme}),/*#__PURE__*/React.createElement(ButtonSmall,{name:\"btnSkip\",alignRight:false,theme:this.state.theme}),/*#__PURE__*/React.createElement(ButtonSmall,{name:\"btnExit\",alignRight:true,theme:this.state.theme})));}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){return{theme:props.theme};}}]);return BoxController;}(React.Component);var ButtonSmall=/*#__PURE__*/function(_React$Component6){_inherits(ButtonSmall,_React$Component6);var _super6=_createSuper(ButtonSmall);function ButtonSmall(props){var _this6;_classCallCheck(this,ButtonSmall);_this6=_super6.call(this,props);_this6.state={theme:'light',clicked:false};return _this6;}_createClass(ButtonSmall,[{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"button\",{id:this.props.name,className:\"button-small theme-\"+this.state.theme+(this.props.alignRight?' align-right':'')});}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){return{theme:props.theme,clicked:props.clicked};}}]);return ButtonSmall;}(React.Component);function App(){initAudio();initData();var element=/*#__PURE__*/React.createElement(Baseplate,{name:currentData.name,message:currentData.message,displayMessage:currentData.displayMessage,displayOnly:currentData.displayOnly,hasImage:currentData.hasImage,epd:currentData.epd,answerEntity:currentData.answerEntity,maxTimeout:currentData.maxTimeout});return element;}export default App;","map":{"version":3,"sources":["/Users/zomme/Github/arete/src/App.js"],"names":["React","styles","data","$","currentData","nextData","ttsBuffer","window","AudioContext","webkitAudioContext","context","initAudio","e","alert","loadTTS","filename","request","XMLHttpRequest","url","open","responseType","onload","decodeAudioData","response","buffer","onError","send","console","log","playSound","source","createBufferSource","connect","destination","start","initData","docID","location","hash","split","each","list","i","name","overwriteData","match","target","message","displayMessage","displayOnly","hasImage","epd","answerEntity","maxTimeout","Baseplate","props","state","duration","currentPlayTime","playStatus","theme","handler","bind","setState","Component","BoxAgent","ButtonAgent","setButtonStatus","param","TextSubtitle","BoxController","setTheme","ButtonSmall","clicked","alignRight","App","element"],"mappings":"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","sourcesContent":["import React from 'react';\nimport styles from './App.css';\nimport data from './testscript.json'\nimport $ from 'jquery';\n\n\n/*\n  UI scheme\n\n ┏━━━━ baseplate ━━━━┓\n ┃  ┏━━━━ AudioController ━━━━┓\n ┃  ┃\n ┃  ┗━━━━━━━━┛  ┃\n ┃  ┏━━━━ BoxAgent ━━━━━━━━━━━━━━━━━━━━━┓\n ┃  ┃  ┏━━━━ ButtonAgent ━━━━━━━━━━━━┓  ┃\n ┃  ┃  ┃  props: playStatus (0/1/2)  ┃  ┃\n ┃  ┃  ┃  state: playStatus (0/1/2)  ┃  ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃\n ┃  ┃  ┏━━━━ TextSubtitle ━━━━━━━━━━━┓  ┃\n ┃  ┃  ┃  props: text (string)       ┃  ┃\n ┃  ┃  ┃         playStatus (0/1/2)  ┃  ┃\n ┃  ┃  ┃  state: playStatus (0/1/2)  ┃  ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃\n ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛\n ┃\n ┃  ┏━━━━ BoxController ━━━━━━━━━━━━━━━━━━━━━━━━┓\n ┃  ┃  props: theme (light / dark)              ┃\n ┃  ┃         playStatus (0/1/2)                ┃\n ┃  ┃  state: theme (light / dark)              ┃\n ┃  ┃         playStatus (0/1/2)                ┃\n ┃  ┃  ┏━━━━ div.box-bar ━━━━━━━━━━━━━━━━━━━━┓  ┃\n ┃  ┃  ┃  ┏━━━━ ProgressBar ━━━━━━━━━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┃  props: playStatus (0/1/2)    ┃  ┃  ┃\n ┃  ┃  ┃  ┃         maxTimeout (int)      ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: playStatus (0/1/2)    ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ div.bar-base ━━━━━━━━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃\n ┃  ┃  ┏━━━━ div.box-buttons ━━━━━━━━━━━━━━━━┓  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnRewind ━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┃  props: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnPlayPause ━━━┓  ┃  ┃\n ┃  ┃  ┃  ┃  props: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┃         playStatus (0/1/2)    ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┃         playStatus (0/1/2)    ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnSkip ━━━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┃  props: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnExit ━━━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┃  props: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃\n ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛\n ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛\n\n\n props and states\n\n playStatus:\n  0: null,\n  1: audio ready,\n  2: playing,\n  3: audio end\n**/\n\n\n\n/* * * * * * * * * * *\n * global variables  *\n * * * * * * * * * * */\n\nconst currentData = {};\nconst nextData = {};\nvar ttsBuffer = null;\n// webAudioAPI Fix up prefixing\nwindow.AudioContext = window.AudioContext || window.webkitAudioContext;\nvar context = new AudioContext();\n\n\n\n/* * * * * * * * * * * * *\n * webAudioAPI functions *\n * * * * * * * * * * * * */\n\nfunction initAudio() {\n  try {\n    // Fix up for prefixing\n    window.AudioContext = window.AudioContext||window.webkitAudioContext;\n    context = new AudioContext();\n  }\n  catch(e) {\n    alert('Web Audio API is not supported in this browser');\n  }\n}\n\nfunction loadTTS(filename) {\n  var request = new XMLHttpRequest();\n  var url = '../src/tts/'+filename+'.mp3';\n  request.open('GET', url, true);\n  request.responseType = 'arraybuffer';\n  // Decode asynchronously\n  request.onload = function() {\n    context.decodeAudioData(request.response, function(buffer) {\n      ttsBuffer = buffer;\n    }, onError);\n  }\n  request.send();\n}\n\nfunction onError(e) {\n  console.log(\"error loading an audio file.\", e);\n}\n\nfunction playSound(buffer) {\n  var source = context.createBufferSource(); // creates a sound source\n  source.buffer = buffer;                    // tell the source which sound to play\n  source.connect(context.destination);       // connect the source to the context's destination (the speakers)\n  source.start(0);                           // play the source now\n                                             // note: on older systems, may have to use deprecated noteOn(time);\n}\n\n\n/* execution */\n\n//functions\nfunction initData(){\n  try {\n    let docID = window.location.hash.split('#');\n    $.each(data.list, function(i){\n      if(data.list[i].name === docID[1]){\n        overwriteData(data.list[i], currentData);\n        if(data.list[i].name.match(/(prompt|statement)/)) {\n        }\n      }\n    });\n  }\n  catch(e) {\n    alert('failed to load data');\n  }\n  loadTTS(currentData.name);\n}\nfunction overwriteData(source, target) {\n  target.name = source.name;\n  target.message = source.message;\n  target.displayMessage = source.displayMessage;\n  target.displayOnly = source.displayOnly;\n  target.hasImage = source.hasImage;\n  target.epd = source.epd;\n  target.answerEntity = source.answerEntity;\n  target.maxTimeout = source.maxTimeout;\n  //target.duration = source.duration;\n}\n\nclass Baseplate extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      name: '',\n      message: '',\n      displayMessage: '',\n      displayOnly: 0,\n      hasImage: 0,\n      epd: 0,\n      answerEntity: '',\n      maxTimeout: 0,\n      duration: 0,\n      currentPlayTime: 0,\n      playStatus: 0,\n      theme: 'light'\n    }\n    this.handler = this.handler.bind(this);\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      name: props.name,\n      message: props.message,\n      displayMessage: props.displayMessage,\n      displayOnly: props.displayOnly,\n      hasImage: props.hasImage,\n      epd: props.epd,\n      answerEntity: props.answerEntity,\n      maxTimeout: props.maxTimeout,\n    };\n  }\n  handler() {\n    if(this.state.playStatus === 2) {\n      this.setState({\n        playStatus: 3,\n        theme: 'light'\n      });\n    }\n    else {\n      this.setState({\n        playStatus: 2,\n        theme: 'dark'\n      });\n    }\n  }\n  render() {\n    return(\n      <div id=\"baseplate\">\n        <BoxAgent\n          playStatus={this.state.playStatus}\n          theme={this.state.theme}\n          displayMessage={this.state.displayMessage}\n          handler={this.handler}\n        />\n        <BoxController\n          theme={this.state.theme}\n          handler={this.handler}\n        />\n      </div>\n    );\n  }\n}\n\n\n\n\n/* * * * * * * * * * * * *\n * BoxAgent and children *\n * * * * * * * * * * * * */\n\nclass BoxAgent extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      playStatus: 0,\n      theme: 'light',\n      displayMessage: \"dummy text\"\n    };\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      playStatus: props.playStatus,\n      theme: props.theme,\n      displayMessage: props.displayMessage\n    };\n  }\n  render() {\n    return(\n      <div className=\"box-agent\">\n        <ButtonAgent\n          playStatus={this.state.playStatus}\n          handler={this.props.handler}\n        />\n        <TextSubtitle theme={this.state.theme} displayMessage={this.state.displayMessage}/>\n      </div>\n    );\n  }\n}\n\nclass ButtonAgent extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      playStatus: 0,\n    };\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      playStatus: props.playStatus\n    };\n  }\n  setButtonStatus = (param) => {\n    switch(param) {\n      case 0: //audio is not loaded\n        return 'idle';\n      case 1: //audio is ready\n        return 'idle';\n      case 2: //audio is playing\n        return 'listening';\n      case 3: //audio ended\n        return 'idle';\n      default:\n        return 'idle';\n    }\n  }\n  render() {\n    return(\n      <button\n        id=\"btnAgent\"\n        className={\"button-agent status-\"+this.setButtonStatus(this.state.playStatus)}\n        onClick={this.props.handler}\n      >\n      </button>\n    );\n  }\n}\n\nclass TextSubtitle extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      theme: 'light',\n      displayMessage: 'dummy text'\n    };\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      theme: props.theme,\n      displayMessage: props.displayMessage\n    };\n  }\n  render() {\n    return(\n      <p\n        id=\"txtSubtitle\"\n        className={\"theme-\"+this.state.theme}\n      >\n        {this.state.displayMessage}\n      </p>\n    );\n  }\n}\n\n/*\nclass AudioController extends React.Component {\n\n}\nclass AudioComp extends React.Component {\n  constructor(props) {\n    super(props);\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      name: props.name,\n      message: props.message,\n      displayMessage: props.displayMessage,\n      displayOnly: props.displayOnly,\n      hasImage: props.hasImage,\n      epd: props.epd,\n      answerEntity: props.answerEntity,\n      maxTimeout: props.maxTimeout,\n      duration: props.duration,\n      currentPlayTime: props.currentPlayTime,\n      playStatus: props.playStatus,\n      theme: props.theme\n    };\n  }\n  render() {\n    return(\n\n    );\n  }\n}\n*/\n\n/* * * * * * * * * * * * * * * *\n * BoxController and children  *\n * * * * * * * * * * * * * * * */\n\nclass BoxController extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      theme: 'light'\n    };\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      theme: props.theme\n    };\n  }\n  setTheme = () => {\n    this.setState({ theme: this.state.theme === 'light' ? 'dark' : 'light' });\n  }\n  render() {\n    return(\n      <div className=\"box-controller\">\n        <div className=\"box-bar\">\n          <div className={\"bar bar-base theme-\"+this.state.theme}\n          onClick={this.setTheme}></div>\n        </div>\n        <div className=\"box-buttons\">\n          <ButtonSmall name=\"btnRewind\" alignRight={false} theme={this.state.theme} />\n          <ButtonSmall name=\"btnSkip\" alignRight={false} theme={this.state.theme} />\n          <ButtonSmall name=\"btnExit\" alignRight={true} theme={this.state.theme} />\n        </div>\n      </div>\n    );\n  }\n}\n\nclass ButtonSmall extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      theme: 'light',\n      clicked: false\n    }\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      theme: props.theme,\n      clicked: props.clicked\n    };\n  }\n  render() {\n    return (\n      <button\n        id={this.props.name}\n        className={\n          \"button-small theme-\"+\n          this.state.theme+\n          (this.props.alignRight ? ' align-right' : '')\n        }\n      >\n      </button>\n    );\n  }\n}\n\n\nfunction App() {\n  initAudio();\n  initData();\n  const element = <Baseplate\n    name={currentData.name}\n    message={currentData.message}\n    displayMessage={currentData.displayMessage}\n    displayOnly={currentData.displayOnly}\n    hasImage={currentData.hasImage}\n    epd={currentData.epd}\n    answerEntity={currentData.answerEntity}\n    maxTimeout={currentData.maxTimeout}\n  />;\n  return(element);\n}\nexport default App;\n"]},"metadata":{},"sourceType":"module"}