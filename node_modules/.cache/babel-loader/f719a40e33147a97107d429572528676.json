{"ast":null,"code":"var _jsxFileName = \"/Users/zomme/Github/arete/src/App.js\";\nimport React from 'react';\nimport styles from './App.css';\nimport data from './testscript.json';\nimport $ from 'jquery';\n/*\n  UI scheme\n\n ┏━━━━ baseplate ━━━━┓\n ┃  ┏━━━━ AudioController ━━━━┓\n ┃  ┃\n ┃  ┗━━━━━━━━┛  ┃\n ┃  ┏━━━━ BoxAgent ━━━━━━━━━━━━━━━━━━━━━┓\n ┃  ┃  ┏━━━━ ButtonAgent ━━━━━━━━━━━━┓  ┃\n ┃  ┃  ┃  props: playStatus (0/1/2)  ┃  ┃\n ┃  ┃  ┃  state: playStatus (0/1/2)  ┃  ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃\n ┃  ┃  ┏━━━━ TextSubtitle ━━━━━━━━━━━┓  ┃\n ┃  ┃  ┃  props: text (string)       ┃  ┃\n ┃  ┃  ┃         playStatus (0/1/2)  ┃  ┃\n ┃  ┃  ┃  state: playStatus (0/1/2)  ┃  ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃\n ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛\n ┃\n ┃  ┏━━━━ BoxController ━━━━━━━━━━━━━━━━━━━━━━━━┓\n ┃  ┃  props: theme (light / dark)              ┃\n ┃  ┃         playStatus (0/1/2)                ┃\n ┃  ┃  state: theme (light / dark)              ┃\n ┃  ┃         playStatus (0/1/2)                ┃\n ┃  ┃  ┏━━━━ div.box-bar ━━━━━━━━━━━━━━━━━━━━┓  ┃\n ┃  ┃  ┃  ┏━━━━ ProgressBar ━━━━━━━━━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┃  props: playStatus (0/1/2)    ┃  ┃  ┃\n ┃  ┃  ┃  ┃         maxTimeout (int)      ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: playStatus (0/1/2)    ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ div.bar-base ━━━━━━━━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃\n ┃  ┃  ┏━━━━ div.box-buttons ━━━━━━━━━━━━━━━━┓  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnRewind ━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┃  props: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnPlayPause ━━━┓  ┃  ┃\n ┃  ┃  ┃  ┃  props: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┃         playStatus (0/1/2)    ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┃         playStatus (0/1/2)    ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnSkip ━━━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┃  props: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnExit ━━━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┃  props: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃\n ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛\n ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛\n\n\n props and states\n\n playStatus:\n  0: null,\n  1: audio ready,\n  2: playing,\n  3: audio end\n**/\n\n/* * * * * * * * * * *\n * global variables  *\n * * * * * * * * * * */\n\nconst currentData = {};\nconst nextData = {};\nvar ttsBuffer = null;\nvar sfxBuffer = null; // webAudioAPI Fix up prefixing\n\nwindow.AudioContext = window.AudioContext || window.webkitAudioContext;\nvar context = new AudioContext();\n/* * * * * * * * * * * * *\n * webAudioAPI functions *\n * * * * * * * * * * * * */\n\nfunction initAudio() {\n  try {\n    // Fix up for prefixing\n    window.AudioContext = window.AudioContext || window.webkitAudioContext;\n    context = new AudioContext();\n  } catch (e) {\n    alert('Web Audio API is not supported in this browser');\n  }\n}\n\nfunction loadSound(filename, type) {\n  var request = new XMLHttpRequest();\n  var url;\n\n  if (type === 'tts') {\n    url = '../src/tts/' + filename + '.mp3';\n  } else {\n    url = '../src/sfx/' + filename + '.wav';\n  }\n\n  request.open('GET', url, true);\n  request.responseType = 'arraybuffer'; // Decode asynchronously\n\n  request.onload = function () {\n    context.decodeAudioData(request.response, function (buffer) {\n      if (type === 'tts') {\n        ttsBuffer = buffer;\n      } else {\n        sfxBuffer = buffer;\n      }\n    }, onError);\n  };\n\n  request.send();\n}\n\nfunction onError(e) {\n  console.log(\"error loading an audio file.\", e);\n}\n\nfunction playSound(buffer) {\n  var source = context.createBufferSource(); // creates a sound source\n\n  source.buffer = buffer; // tell the source which sound to play\n\n  source.connect(context.destination); // connect the source to the context's destination (the speakers)\n\n  source.start(0); // play the source now\n  // note: on older systems, may have to use deprecated noteOn(time);\n}\n/* execution */\n//functions\n\n\nfunction initData() {\n  try {\n    let docID = window.location.hash.split('#');\n    $.each(data.list, function (i) {\n      if (data.list[i].name === docID[1]) {\n        overwriteData(data.list[i], currentData);\n\n        if (data.list[i].name.match(/(prompt|statement)/)) {}\n      }\n    });\n  } catch (e) {\n    alert('failed to load data');\n  }\n}\n\nfunction overwriteData(source, target) {\n  target.name = source.name;\n  target.message = source.message;\n  target.displayMessage = source.displayMessage;\n  target.displayOnly = source.displayOnly;\n  target.hasImage = source.hasImage;\n  target.epd = source.epd;\n  target.answerEntity = source.answerEntity;\n  target.maxTimeout = source.maxTimeout; //target.duration = source.duration;\n}\n\nclass Baseplate extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      name: '',\n      message: '',\n      displayMessage: '',\n      displayOnly: 0,\n      hasImage: 0,\n      epd: 0,\n      answerEntity: '',\n      maxTimeout: 0,\n      duration: 0,\n      currentPlayTime: 0,\n      playStatus: 0,\n      theme: 'light'\n    };\n    this.handler = this.handler.bind(this);\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    return {\n      name: props.name,\n      message: props.message,\n      displayMessage: props.displayMessage,\n      displayOnly: props.displayOnly,\n      hasImage: props.hasImage,\n      epd: props.epd,\n      answerEntity: props.answerEntity,\n      maxTimeout: props.maxTimeout\n    };\n  }\n\n  handler() {\n    if (this.state.playStatus === 2) {\n      this.setState({\n        playStatus: 3,\n        theme: 'light'\n      });\n    } else {\n      this.setState({\n        playStatus: 2,\n        theme: 'dark'\n      });\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      id: \"baseplate\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(TTSComp, {\n      name: this.state.name,\n      duration: this.state.duration,\n      currentPlayTime: this.state.currentPlayTime,\n      playStatus: this.state.playStatus,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(BoxAgent, {\n      playStatus: this.state.playStatus,\n      theme: this.state.theme,\n      displayMessage: this.state.displayMessage,\n      handler: this.handler,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(BoxController, {\n      theme: this.state.theme,\n      handler: this.handler,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\n/* * * * * * * * * * * * *\n * BoxAgent and children *\n * * * * * * * * * * * * */\n\n\nclass BoxAgent extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      playStatus: 0,\n      theme: 'light',\n      displayMessage: \"dummy text\"\n    };\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    return {\n      playStatus: props.playStatus,\n      theme: props.theme,\n      displayMessage: props.displayMessage\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"box-agent\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(ButtonAgent, {\n      playStatus: this.state.playStatus,\n      handler: this.props.handler,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 266,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(TextSubtitle, {\n      theme: this.state.theme,\n      displayMessage: this.state.displayMessage,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 9\n      }\n    }));\n  }\n\n}\n\nclass ButtonAgent extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.setButtonStatus = param => {\n      switch (param) {\n        case 0:\n          //audio is not loaded\n          return 'idle';\n\n        case 1:\n          //audio is ready\n          return 'idle';\n\n        case 2:\n          //audio is playing\n          return 'listening';\n\n        case 3:\n          //audio ended\n          return 'idle';\n\n        default:\n          return 'idle';\n      }\n    };\n\n    this.state = {\n      playStatus: 0\n    };\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    return {\n      playStatus: props.playStatus\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"button\", {\n      id: \"btnAgent\",\n      className: \"button-agent status-\" + this.setButtonStatus(this.state.playStatus),\n      onClick: this.props.handler,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 7\n      }\n    });\n  }\n\n}\n\nclass TextSubtitle extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      theme: 'light',\n      displayMessage: 'dummy text'\n    };\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    return {\n      theme: props.theme,\n      displayMessage: props.displayMessage\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"p\", {\n      id: \"txtSubtitle\",\n      className: \"theme-\" + this.state.theme,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 330,\n        columnNumber: 7\n      }\n    }, this.state.displayMessage);\n  }\n\n}\n\nclass TTSComp extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      name: '',\n      duration: 0,\n      currentPlayTime: 0,\n      playStatus: 0\n    };\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    return {\n      name: props.name,\n      duration: props.duration,\n      currentPlayTime: props.currentPlayTime,\n      playStatus: props.playStatus\n    };\n  }\n\n  componentDidMount() {\n    loadSound('sft_listening', 'sfx');\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"audio\", {\n      id: this.state.name,\n      src: '../src/tts/' + this.state.name + '.mp3',\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 363,\n        columnNumber: 7\n      }\n    });\n  }\n\n}\n/* * * * * * * * * * * * * * * *\n * BoxController and children  *\n * * * * * * * * * * * * * * * */\n\n\nclass BoxController extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.setTheme = () => {\n      this.setState({\n        theme: this.state.theme === 'light' ? 'dark' : 'light'\n      });\n    };\n\n    this.state = {\n      theme: 'light'\n    };\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    return {\n      theme: props.theme\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"box-controller\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 392,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"box-bar\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 393,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"bar bar-base theme-\" + this.state.theme,\n      onClick: this.setTheme,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 394,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"box-buttons\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 397,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(ButtonSmall, {\n      name: \"btnRewind\",\n      alignRight: false,\n      theme: this.state.theme,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 398,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(ButtonSmall, {\n      name: \"btnSkip\",\n      alignRight: false,\n      theme: this.state.theme,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 403,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(ButtonSmall, {\n      name: \"btnExit\",\n      alignRight: true,\n      theme: this.state.theme,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 404,\n        columnNumber: 11\n      }\n    })));\n  }\n\n}\n\nclass ButtonSmall extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      theme: 'light',\n      clicked: false\n    };\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    return {\n      theme: props.theme,\n      clicked: props.clicked\n    };\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"button\", {\n      id: this.props.name,\n      className: \"button-small theme-\" + this.state.theme + (this.props.alignRight ? ' align-right' : ''),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 427,\n        columnNumber: 7\n      }\n    });\n  }\n\n}\n\nfunction App() {\n  initAudio();\n  initData();\n  const element = /*#__PURE__*/React.createElement(Baseplate, {\n    name: currentData.name,\n    message: currentData.message,\n    displayMessage: currentData.displayMessage,\n    displayOnly: currentData.displayOnly,\n    hasImage: currentData.hasImage,\n    epd: currentData.epd,\n    answerEntity: currentData.answerEntity,\n    maxTimeout: currentData.maxTimeout,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 444,\n      columnNumber: 19\n    }\n  });\n  return element;\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/zomme/Github/arete/src/App.js"],"names":["React","styles","data","$","currentData","nextData","ttsBuffer","sfxBuffer","window","AudioContext","webkitAudioContext","context","initAudio","e","alert","loadSound","filename","type","request","XMLHttpRequest","url","open","responseType","onload","decodeAudioData","response","buffer","onError","send","console","log","playSound","source","createBufferSource","connect","destination","start","initData","docID","location","hash","split","each","list","i","name","overwriteData","match","target","message","displayMessage","displayOnly","hasImage","epd","answerEntity","maxTimeout","Baseplate","Component","constructor","props","state","duration","currentPlayTime","playStatus","theme","handler","bind","getDerivedStateFromProps","setState","render","BoxAgent","ButtonAgent","setButtonStatus","param","TextSubtitle","TTSComp","componentDidMount","BoxController","setTheme","ButtonSmall","clicked","alignRight","App","element"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,OAAOC,IAAP,MAAiB,mBAAjB;AACA,OAAOC,CAAP,MAAc,QAAd;AAGA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoEA;;;;AAIA,MAAMC,WAAW,GAAG,EAApB;AACA,MAAMC,QAAQ,GAAG,EAAjB;AACA,IAAIC,SAAS,GAAG,IAAhB;AACA,IAAIC,SAAS,GAAG,IAAhB,C,CACA;;AACAC,MAAM,CAACC,YAAP,GAAsBD,MAAM,CAACC,YAAP,IAAuBD,MAAM,CAACE,kBAApD;AACA,IAAIC,OAAO,GAAG,IAAIF,YAAJ,EAAd;AAIA;;;;AAIA,SAASG,SAAT,GAAqB;AACnB,MAAI;AACF;AACAJ,IAAAA,MAAM,CAACC,YAAP,GAAsBD,MAAM,CAACC,YAAP,IAAqBD,MAAM,CAACE,kBAAlD;AACAC,IAAAA,OAAO,GAAG,IAAIF,YAAJ,EAAV;AACD,GAJD,CAKA,OAAMI,CAAN,EAAS;AACPC,IAAAA,KAAK,CAAC,gDAAD,CAAL;AACD;AACF;;AAED,SAASC,SAAT,CAAmBC,QAAnB,EAA6BC,IAA7B,EAAmC;AACjC,MAAIC,OAAO,GAAG,IAAIC,cAAJ,EAAd;AACA,MAAIC,GAAJ;;AACA,MAAGH,IAAI,KAAK,KAAZ,EAAmB;AACjBG,IAAAA,GAAG,GAAG,gBAAcJ,QAAd,GAAuB,MAA7B;AACD,GAFD,MAGK;AACHI,IAAAA,GAAG,GAAG,gBAAcJ,QAAd,GAAuB,MAA7B;AACD;;AACDE,EAAAA,OAAO,CAACG,IAAR,CAAa,KAAb,EAAoBD,GAApB,EAAyB,IAAzB;AACAF,EAAAA,OAAO,CAACI,YAAR,GAAuB,aAAvB,CAViC,CAWjC;;AACAJ,EAAAA,OAAO,CAACK,MAAR,GAAiB,YAAW;AAC1BZ,IAAAA,OAAO,CAACa,eAAR,CAAwBN,OAAO,CAACO,QAAhC,EAA0C,UAASC,MAAT,EAAiB;AACzD,UAAGT,IAAI,KAAK,KAAZ,EAAmB;AACfX,QAAAA,SAAS,GAAGoB,MAAZ;AACH,OAFD,MAGK;AACHnB,QAAAA,SAAS,GAAGmB,MAAZ;AACD;AACF,KAPD,EAOGC,OAPH;AAQD,GATD;;AAUAT,EAAAA,OAAO,CAACU,IAAR;AACD;;AAED,SAASD,OAAT,CAAiBd,CAAjB,EAAoB;AAClBgB,EAAAA,OAAO,CAACC,GAAR,CAAY,8BAAZ,EAA4CjB,CAA5C;AACD;;AAED,SAASkB,SAAT,CAAmBL,MAAnB,EAA2B;AACzB,MAAIM,MAAM,GAAGrB,OAAO,CAACsB,kBAAR,EAAb,CADyB,CACkB;;AAC3CD,EAAAA,MAAM,CAACN,MAAP,GAAgBA,MAAhB,CAFyB,CAEkB;;AAC3CM,EAAAA,MAAM,CAACE,OAAP,CAAevB,OAAO,CAACwB,WAAvB,EAHyB,CAGkB;;AAC3CH,EAAAA,MAAM,CAACI,KAAP,CAAa,CAAb,EAJyB,CAIkB;AACA;AAC5C;AAED;AAEA;;;AACA,SAASC,QAAT,GAAmB;AACjB,MAAI;AACF,QAAIC,KAAK,GAAG9B,MAAM,CAAC+B,QAAP,CAAgBC,IAAhB,CAAqBC,KAArB,CAA2B,GAA3B,CAAZ;AACAtC,IAAAA,CAAC,CAACuC,IAAF,CAAOxC,IAAI,CAACyC,IAAZ,EAAkB,UAASC,CAAT,EAAW;AAC3B,UAAG1C,IAAI,CAACyC,IAAL,CAAUC,CAAV,EAAaC,IAAb,KAAsBP,KAAK,CAAC,CAAD,CAA9B,EAAkC;AAChCQ,QAAAA,aAAa,CAAC5C,IAAI,CAACyC,IAAL,CAAUC,CAAV,CAAD,EAAexC,WAAf,CAAb;;AACA,YAAGF,IAAI,CAACyC,IAAL,CAAUC,CAAV,EAAaC,IAAb,CAAkBE,KAAlB,CAAwB,oBAAxB,CAAH,EAAkD,CACjD;AACF;AACF,KAND;AAOD,GATD,CAUA,OAAMlC,CAAN,EAAS;AACPC,IAAAA,KAAK,CAAC,qBAAD,CAAL;AACD;AACF;;AACD,SAASgC,aAAT,CAAuBd,MAAvB,EAA+BgB,MAA/B,EAAuC;AACrCA,EAAAA,MAAM,CAACH,IAAP,GAAcb,MAAM,CAACa,IAArB;AACAG,EAAAA,MAAM,CAACC,OAAP,GAAiBjB,MAAM,CAACiB,OAAxB;AACAD,EAAAA,MAAM,CAACE,cAAP,GAAwBlB,MAAM,CAACkB,cAA/B;AACAF,EAAAA,MAAM,CAACG,WAAP,GAAqBnB,MAAM,CAACmB,WAA5B;AACAH,EAAAA,MAAM,CAACI,QAAP,GAAkBpB,MAAM,CAACoB,QAAzB;AACAJ,EAAAA,MAAM,CAACK,GAAP,GAAarB,MAAM,CAACqB,GAApB;AACAL,EAAAA,MAAM,CAACM,YAAP,GAAsBtB,MAAM,CAACsB,YAA7B;AACAN,EAAAA,MAAM,CAACO,UAAP,GAAoBvB,MAAM,CAACuB,UAA3B,CARqC,CASrC;AACD;;AAED,MAAMC,SAAN,SAAwBxD,KAAK,CAACyD,SAA9B,CAAwC;AACtCC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAa;AACXf,MAAAA,IAAI,EAAE,EADK;AAEXI,MAAAA,OAAO,EAAE,EAFE;AAGXC,MAAAA,cAAc,EAAE,EAHL;AAIXC,MAAAA,WAAW,EAAE,CAJF;AAKXC,MAAAA,QAAQ,EAAE,CALC;AAMXC,MAAAA,GAAG,EAAE,CANM;AAOXC,MAAAA,YAAY,EAAE,EAPH;AAQXC,MAAAA,UAAU,EAAE,CARD;AASXM,MAAAA,QAAQ,EAAE,CATC;AAUXC,MAAAA,eAAe,EAAE,CAVN;AAWXC,MAAAA,UAAU,EAAE,CAXD;AAYXC,MAAAA,KAAK,EAAE;AAZI,KAAb;AAcA,SAAKC,OAAL,GAAe,KAAKA,OAAL,CAAaC,IAAb,CAAkB,IAAlB,CAAf;AACD;;AACD,SAAOC,wBAAP,CAAgCR,KAAhC,EAAuCC,KAAvC,EAA8C;AAC5C,WAAO;AACLf,MAAAA,IAAI,EAAEc,KAAK,CAACd,IADP;AAELI,MAAAA,OAAO,EAAEU,KAAK,CAACV,OAFV;AAGLC,MAAAA,cAAc,EAAES,KAAK,CAACT,cAHjB;AAILC,MAAAA,WAAW,EAAEQ,KAAK,CAACR,WAJd;AAKLC,MAAAA,QAAQ,EAAEO,KAAK,CAACP,QALX;AAMLC,MAAAA,GAAG,EAAEM,KAAK,CAACN,GANN;AAOLC,MAAAA,YAAY,EAAEK,KAAK,CAACL,YAPf;AAQLC,MAAAA,UAAU,EAAEI,KAAK,CAACJ;AARb,KAAP;AAUD;;AACDU,EAAAA,OAAO,GAAG;AACR,QAAG,KAAKL,KAAL,CAAWG,UAAX,KAA0B,CAA7B,EAAgC;AAC9B,WAAKK,QAAL,CAAc;AACZL,QAAAA,UAAU,EAAE,CADA;AAEZC,QAAAA,KAAK,EAAE;AAFK,OAAd;AAID,KALD,MAMK;AACH,WAAKI,QAAL,CAAc;AACZL,QAAAA,UAAU,EAAE,CADA;AAEZC,QAAAA,KAAK,EAAE;AAFK,OAAd;AAID;AACF;;AACDK,EAAAA,MAAM,GAAG;AACP,wBACE;AAAK,MAAA,EAAE,EAAC,WAAR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,OAAD;AACE,MAAA,IAAI,EAAE,KAAKT,KAAL,CAAWf,IADnB;AAEE,MAAA,QAAQ,EAAE,KAAKe,KAAL,CAAWC,QAFvB;AAGE,MAAA,eAAe,EAAE,KAAKD,KAAL,CAAWE,eAH9B;AAIE,MAAA,UAAU,EAAE,KAAKF,KAAL,CAAWG,UAJzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,eAOE,oBAAC,QAAD;AACE,MAAA,UAAU,EAAE,KAAKH,KAAL,CAAWG,UADzB;AAEE,MAAA,KAAK,EAAE,KAAKH,KAAL,CAAWI,KAFpB;AAGE,MAAA,cAAc,EAAE,KAAKJ,KAAL,CAAWV,cAH7B;AAIE,MAAA,OAAO,EAAE,KAAKe,OAJhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAPF,eAaE,oBAAC,aAAD;AACE,MAAA,KAAK,EAAE,KAAKL,KAAL,CAAWI,KADpB;AAEE,MAAA,OAAO,EAAE,KAAKC,OAFhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAbF,CADF;AAoBD;;AAlEqC;AAwExC;;;;;AAIA,MAAMK,QAAN,SAAuBtE,KAAK,CAACyD,SAA7B,CAAuC;AACrCC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAa;AACXG,MAAAA,UAAU,EAAE,CADD;AAEXC,MAAAA,KAAK,EAAE,OAFI;AAGXd,MAAAA,cAAc,EAAE;AAHL,KAAb;AAKD;;AACD,SAAOiB,wBAAP,CAAgCR,KAAhC,EAAuCC,KAAvC,EAA8C;AAC5C,WAAO;AACLG,MAAAA,UAAU,EAAEJ,KAAK,CAACI,UADb;AAELC,MAAAA,KAAK,EAAEL,KAAK,CAACK,KAFR;AAGLd,MAAAA,cAAc,EAAES,KAAK,CAACT;AAHjB,KAAP;AAKD;;AACDmB,EAAAA,MAAM,GAAG;AACP,wBACE;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,WAAD;AACE,MAAA,UAAU,EAAE,KAAKT,KAAL,CAAWG,UADzB;AAEE,MAAA,OAAO,EAAE,KAAKJ,KAAL,CAAWM,OAFtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,eAKE,oBAAC,YAAD;AAAc,MAAA,KAAK,EAAE,KAAKL,KAAL,CAAWI,KAAhC;AAAuC,MAAA,cAAc,EAAE,KAAKJ,KAAL,CAAWV,cAAlE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MALF,CADF;AASD;;AA1BoC;;AA6BvC,MAAMqB,WAAN,SAA0BvE,KAAK,CAACyD,SAAhC,CAA0C;AACxCC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,SAWnBa,eAXmB,GAWAC,KAAD,IAAW;AAC3B,cAAOA,KAAP;AACE,aAAK,CAAL;AAAQ;AACN,iBAAO,MAAP;;AACF,aAAK,CAAL;AAAQ;AACN,iBAAO,MAAP;;AACF,aAAK,CAAL;AAAQ;AACN,iBAAO,WAAP;;AACF,aAAK,CAAL;AAAQ;AACN,iBAAO,MAAP;;AACF;AACE,iBAAO,MAAP;AAVJ;AAYD,KAxBkB;;AAEjB,SAAKb,KAAL,GAAa;AACXG,MAAAA,UAAU,EAAE;AADD,KAAb;AAGD;;AACD,SAAOI,wBAAP,CAAgCR,KAAhC,EAAuCC,KAAvC,EAA8C;AAC5C,WAAO;AACLG,MAAAA,UAAU,EAAEJ,KAAK,CAACI;AADb,KAAP;AAGD;;AAeDM,EAAAA,MAAM,GAAG;AACP,wBACE;AACE,MAAA,EAAE,EAAC,UADL;AAEE,MAAA,SAAS,EAAE,yBAAuB,KAAKG,eAAL,CAAqB,KAAKZ,KAAL,CAAWG,UAAhC,CAFpC;AAGE,MAAA,OAAO,EAAE,KAAKJ,KAAL,CAAWM,OAHtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF;AAQD;;AAnCuC;;AAsC1C,MAAMS,YAAN,SAA2B1E,KAAK,CAACyD,SAAjC,CAA2C;AACzCC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAa;AACXI,MAAAA,KAAK,EAAE,OADI;AAEXd,MAAAA,cAAc,EAAE;AAFL,KAAb;AAID;;AACD,SAAOiB,wBAAP,CAAgCR,KAAhC,EAAuCC,KAAvC,EAA8C;AAC5C,WAAO;AACLI,MAAAA,KAAK,EAAEL,KAAK,CAACK,KADR;AAELd,MAAAA,cAAc,EAAES,KAAK,CAACT;AAFjB,KAAP;AAID;;AACDmB,EAAAA,MAAM,GAAG;AACP,wBACE;AACE,MAAA,EAAE,EAAC,aADL;AAEE,MAAA,SAAS,EAAE,WAAS,KAAKT,KAAL,CAAWI,KAFjC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAIG,KAAKJ,KAAL,CAAWV,cAJd,CADF;AAQD;;AAvBwC;;AA0B3C,MAAMyB,OAAN,SAAsB3E,KAAK,CAACyD,SAA5B,CAAsC;AACpCC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAa;AACXf,MAAAA,IAAI,EAAE,EADK;AAEXgB,MAAAA,QAAQ,EAAE,CAFC;AAGXC,MAAAA,eAAe,EAAE,CAHN;AAIXC,MAAAA,UAAU,EAAE;AAJD,KAAb;AAMD;;AACD,SAAOI,wBAAP,CAAgCR,KAAhC,EAAuCC,KAAvC,EAA8C;AAC5C,WAAO;AACLf,MAAAA,IAAI,EAAEc,KAAK,CAACd,IADP;AAELgB,MAAAA,QAAQ,EAAEF,KAAK,CAACE,QAFX;AAGLC,MAAAA,eAAe,EAAEH,KAAK,CAACG,eAHlB;AAILC,MAAAA,UAAU,EAAEJ,KAAK,CAACI;AAJb,KAAP;AAMD;;AACDa,EAAAA,iBAAiB,GAAG;AAClB7D,IAAAA,SAAS,CAAC,eAAD,EAAkB,KAAlB,CAAT;AACD;;AACDsD,EAAAA,MAAM,GAAG;AACP,wBACE;AACE,MAAA,EAAE,EAAE,KAAKT,KAAL,CAAWf,IADjB;AAEE,MAAA,GAAG,EAAE,gBAAc,KAAKe,KAAL,CAAWf,IAAzB,GAA8B,MAFrC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF;AAMD;;AA5BmC;AA+BtC;;;;;AAIA,MAAMgC,aAAN,SAA4B7E,KAAK,CAACyD,SAAlC,CAA4C;AAC1CC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,SAWnBmB,QAXmB,GAWR,MAAM;AACf,WAAKV,QAAL,CAAc;AAAEJ,QAAAA,KAAK,EAAE,KAAKJ,KAAL,CAAWI,KAAX,KAAqB,OAArB,GAA+B,MAA/B,GAAwC;AAAjD,OAAd;AACD,KAbkB;;AAEjB,SAAKJ,KAAL,GAAa;AACXI,MAAAA,KAAK,EAAE;AADI,KAAb;AAGD;;AACD,SAAOG,wBAAP,CAAgCR,KAAhC,EAAuCC,KAAvC,EAA8C;AAC5C,WAAO;AACLI,MAAAA,KAAK,EAAEL,KAAK,CAACK;AADR,KAAP;AAGD;;AAIDK,EAAAA,MAAM,GAAG;AACP,wBACE;AAAK,MAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAC,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE;AAAK,MAAA,SAAS,EAAE,wBAAsB,KAAKT,KAAL,CAAWI,KAAjD;AACA,MAAA,OAAO,EAAE,KAAKc,QADd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,CADF,eAKE;AAAK,MAAA,SAAS,EAAC,aAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACE,oBAAC,WAAD;AACE,MAAA,IAAI,EAAC,WADP;AAEE,MAAA,UAAU,EAAE,KAFd;AAGE,MAAA,KAAK,EAAE,KAAKlB,KAAL,CAAWI,KAHpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF,eAME,oBAAC,WAAD;AAAa,MAAA,IAAI,EAAC,SAAlB;AAA4B,MAAA,UAAU,EAAE,KAAxC;AAA+C,MAAA,KAAK,EAAE,KAAKJ,KAAL,CAAWI,KAAjE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MANF,eAOE,oBAAC,WAAD;AAAa,MAAA,IAAI,EAAC,SAAlB;AAA4B,MAAA,UAAU,EAAE,IAAxC;AAA8C,MAAA,KAAK,EAAE,KAAKJ,KAAL,CAAWI,KAAhE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAPF,CALF,CADF;AAiBD;;AAjCyC;;AAoC5C,MAAMe,WAAN,SAA0B/E,KAAK,CAACyD,SAAhC,CAA0C;AACxCC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAa;AACXI,MAAAA,KAAK,EAAE,OADI;AAEXgB,MAAAA,OAAO,EAAE;AAFE,KAAb;AAID;;AACD,SAAOb,wBAAP,CAAgCR,KAAhC,EAAuCC,KAAvC,EAA8C;AAC5C,WAAO;AACLI,MAAAA,KAAK,EAAEL,KAAK,CAACK,KADR;AAELgB,MAAAA,OAAO,EAAErB,KAAK,CAACqB;AAFV,KAAP;AAID;;AACDX,EAAAA,MAAM,GAAG;AACP,wBACE;AACE,MAAA,EAAE,EAAE,KAAKV,KAAL,CAAWd,IADjB;AAEE,MAAA,SAAS,EACP,wBACA,KAAKe,KAAL,CAAWI,KADX,IAEC,KAAKL,KAAL,CAAWsB,UAAX,GAAwB,cAAxB,GAAyC,EAF1C,CAHJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADF;AAWD;;AA1BuC;;AA8B1C,SAASC,GAAT,GAAe;AACbtE,EAAAA,SAAS;AACTyB,EAAAA,QAAQ;AACR,QAAM8C,OAAO,gBAAG,oBAAC,SAAD;AACd,IAAA,IAAI,EAAE/E,WAAW,CAACyC,IADJ;AAEd,IAAA,OAAO,EAAEzC,WAAW,CAAC6C,OAFP;AAGd,IAAA,cAAc,EAAE7C,WAAW,CAAC8C,cAHd;AAId,IAAA,WAAW,EAAE9C,WAAW,CAAC+C,WAJX;AAKd,IAAA,QAAQ,EAAE/C,WAAW,CAACgD,QALR;AAMd,IAAA,GAAG,EAAEhD,WAAW,CAACiD,GANH;AAOd,IAAA,YAAY,EAAEjD,WAAW,CAACkD,YAPZ;AAQd,IAAA,UAAU,EAAElD,WAAW,CAACmD,UARV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAhB;AAUA,SAAO4B,OAAP;AACD;;AACD,eAAeD,GAAf","sourcesContent":["import React from 'react';\nimport styles from './App.css';\nimport data from './testscript.json'\nimport $ from 'jquery';\n\n\n/*\n  UI scheme\n\n ┏━━━━ baseplate ━━━━┓\n ┃  ┏━━━━ AudioController ━━━━┓\n ┃  ┃\n ┃  ┗━━━━━━━━┛  ┃\n ┃  ┏━━━━ BoxAgent ━━━━━━━━━━━━━━━━━━━━━┓\n ┃  ┃  ┏━━━━ ButtonAgent ━━━━━━━━━━━━┓  ┃\n ┃  ┃  ┃  props: playStatus (0/1/2)  ┃  ┃\n ┃  ┃  ┃  state: playStatus (0/1/2)  ┃  ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃\n ┃  ┃  ┏━━━━ TextSubtitle ━━━━━━━━━━━┓  ┃\n ┃  ┃  ┃  props: text (string)       ┃  ┃\n ┃  ┃  ┃         playStatus (0/1/2)  ┃  ┃\n ┃  ┃  ┃  state: playStatus (0/1/2)  ┃  ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃\n ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛\n ┃\n ┃  ┏━━━━ BoxController ━━━━━━━━━━━━━━━━━━━━━━━━┓\n ┃  ┃  props: theme (light / dark)              ┃\n ┃  ┃         playStatus (0/1/2)                ┃\n ┃  ┃  state: theme (light / dark)              ┃\n ┃  ┃         playStatus (0/1/2)                ┃\n ┃  ┃  ┏━━━━ div.box-bar ━━━━━━━━━━━━━━━━━━━━┓  ┃\n ┃  ┃  ┃  ┏━━━━ ProgressBar ━━━━━━━━━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┃  props: playStatus (0/1/2)    ┃  ┃  ┃\n ┃  ┃  ┃  ┃         maxTimeout (int)      ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: playStatus (0/1/2)    ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ div.bar-base ━━━━━━━━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃\n ┃  ┃  ┏━━━━ div.box-buttons ━━━━━━━━━━━━━━━━┓  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnRewind ━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┃  props: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnPlayPause ━━━┓  ┃  ┃\n ┃  ┃  ┃  ┃  props: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┃         playStatus (0/1/2)    ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┃         playStatus (0/1/2)    ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnSkip ━━━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┃  props: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┃  ┏━━━━ BtnSmall #btnExit ━━━━━━━━┓  ┃  ┃\n ┃  ┃  ┃  ┃  props: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┃  state: theme (light / dark)  ┃  ┃  ┃\n ┃  ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃  ┃\n ┃  ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛  ┃\n ┃  ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛\n ┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛\n\n\n props and states\n\n playStatus:\n  0: null,\n  1: audio ready,\n  2: playing,\n  3: audio end\n**/\n\n\n\n/* * * * * * * * * * *\n * global variables  *\n * * * * * * * * * * */\n\nconst currentData = {};\nconst nextData = {};\nvar ttsBuffer = null;\nvar sfxBuffer = null;\n// webAudioAPI Fix up prefixing\nwindow.AudioContext = window.AudioContext || window.webkitAudioContext;\nvar context = new AudioContext();\n\n\n\n/* * * * * * * * * * * * *\n * webAudioAPI functions *\n * * * * * * * * * * * * */\n\nfunction initAudio() {\n  try {\n    // Fix up for prefixing\n    window.AudioContext = window.AudioContext||window.webkitAudioContext;\n    context = new AudioContext();\n  }\n  catch(e) {\n    alert('Web Audio API is not supported in this browser');\n  }\n}\n\nfunction loadSound(filename, type) {\n  var request = new XMLHttpRequest();\n  var url;\n  if(type === 'tts') {\n    url = '../src/tts/'+filename+'.mp3';\n  }\n  else {\n    url = '../src/sfx/'+filename+'.wav';\n  }\n  request.open('GET', url, true);\n  request.responseType = 'arraybuffer';\n  // Decode asynchronously\n  request.onload = function() {\n    context.decodeAudioData(request.response, function(buffer) {\n      if(type === 'tts') {\n          ttsBuffer = buffer;\n      }\n      else {\n        sfxBuffer = buffer;\n      }\n    }, onError);\n  }\n  request.send();\n}\n\nfunction onError(e) {\n  console.log(\"error loading an audio file.\", e);\n}\n\nfunction playSound(buffer) {\n  var source = context.createBufferSource(); // creates a sound source\n  source.buffer = buffer;                    // tell the source which sound to play\n  source.connect(context.destination);       // connect the source to the context's destination (the speakers)\n  source.start(0);                           // play the source now\n                                             // note: on older systems, may have to use deprecated noteOn(time);\n}\n\n/* execution */\n\n//functions\nfunction initData(){\n  try {\n    let docID = window.location.hash.split('#');\n    $.each(data.list, function(i){\n      if(data.list[i].name === docID[1]){\n        overwriteData(data.list[i], currentData);\n        if(data.list[i].name.match(/(prompt|statement)/)) {\n        }\n      }\n    });\n  }\n  catch(e) {\n    alert('failed to load data');\n  }\n}\nfunction overwriteData(source, target) {\n  target.name = source.name;\n  target.message = source.message;\n  target.displayMessage = source.displayMessage;\n  target.displayOnly = source.displayOnly;\n  target.hasImage = source.hasImage;\n  target.epd = source.epd;\n  target.answerEntity = source.answerEntity;\n  target.maxTimeout = source.maxTimeout;\n  //target.duration = source.duration;\n}\n\nclass Baseplate extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      name: '',\n      message: '',\n      displayMessage: '',\n      displayOnly: 0,\n      hasImage: 0,\n      epd: 0,\n      answerEntity: '',\n      maxTimeout: 0,\n      duration: 0,\n      currentPlayTime: 0,\n      playStatus: 0,\n      theme: 'light'\n    }\n    this.handler = this.handler.bind(this);\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      name: props.name,\n      message: props.message,\n      displayMessage: props.displayMessage,\n      displayOnly: props.displayOnly,\n      hasImage: props.hasImage,\n      epd: props.epd,\n      answerEntity: props.answerEntity,\n      maxTimeout: props.maxTimeout,\n    };\n  }\n  handler() {\n    if(this.state.playStatus === 2) {\n      this.setState({\n        playStatus: 3,\n        theme: 'light'\n      });\n    }\n    else {\n      this.setState({\n        playStatus: 2,\n        theme: 'dark'\n      });\n    }\n  }\n  render() {\n    return(\n      <div id=\"baseplate\">\n        <TTSComp\n          name={this.state.name}\n          duration={this.state.duration}\n          currentPlayTime={this.state.currentPlayTime}\n          playStatus={this.state.playStatus}\n        />\n        <BoxAgent\n          playStatus={this.state.playStatus}\n          theme={this.state.theme}\n          displayMessage={this.state.displayMessage}\n          handler={this.handler}\n        />\n        <BoxController\n          theme={this.state.theme}\n          handler={this.handler}\n        />\n      </div>\n    );\n  }\n}\n\n\n\n\n/* * * * * * * * * * * * *\n * BoxAgent and children *\n * * * * * * * * * * * * */\n\nclass BoxAgent extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      playStatus: 0,\n      theme: 'light',\n      displayMessage: \"dummy text\"\n    };\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      playStatus: props.playStatus,\n      theme: props.theme,\n      displayMessage: props.displayMessage\n    };\n  }\n  render() {\n    return(\n      <div className=\"box-agent\">\n        <ButtonAgent\n          playStatus={this.state.playStatus}\n          handler={this.props.handler}\n        />\n        <TextSubtitle theme={this.state.theme} displayMessage={this.state.displayMessage}/>\n      </div>\n    );\n  }\n}\n\nclass ButtonAgent extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      playStatus: 0,\n    };\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      playStatus: props.playStatus\n    };\n  }\n  setButtonStatus = (param) => {\n    switch(param) {\n      case 0: //audio is not loaded\n        return 'idle';\n      case 1: //audio is ready\n        return 'idle';\n      case 2: //audio is playing\n        return 'listening';\n      case 3: //audio ended\n        return 'idle';\n      default:\n        return 'idle';\n    }\n  }\n  render() {\n    return(\n      <button\n        id=\"btnAgent\"\n        className={\"button-agent status-\"+this.setButtonStatus(this.state.playStatus)}\n        onClick={this.props.handler}\n      >\n      </button>\n    );\n  }\n}\n\nclass TextSubtitle extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      theme: 'light',\n      displayMessage: 'dummy text'\n    };\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      theme: props.theme,\n      displayMessage: props.displayMessage\n    };\n  }\n  render() {\n    return(\n      <p\n        id=\"txtSubtitle\"\n        className={\"theme-\"+this.state.theme}\n      >\n        {this.state.displayMessage}\n      </p>\n    );\n  }\n}\n\nclass TTSComp extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      name: '',\n      duration: 0,\n      currentPlayTime: 0,\n      playStatus: 0\n    }\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      name: props.name,\n      duration: props.duration,\n      currentPlayTime: props.currentPlayTime,\n      playStatus: props.playStatus\n    };\n  }\n  componentDidMount() {\n    loadSound('sft_listening', 'sfx');\n  }\n  render() {\n    return(\n      <audio\n        id={this.state.name}\n        src={'../src/tts/'+this.state.name+'.mp3'}\n      />\n    );\n  }\n}\n\n/* * * * * * * * * * * * * * * *\n * BoxController and children  *\n * * * * * * * * * * * * * * * */\n\nclass BoxController extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      theme: 'light'\n    };\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      theme: props.theme\n    };\n  }\n  setTheme = () => {\n    this.setState({ theme: this.state.theme === 'light' ? 'dark' : 'light' });\n  }\n  render() {\n    return(\n      <div className=\"box-controller\">\n        <div className=\"box-bar\">\n          <div className={\"bar bar-base theme-\"+this.state.theme}\n          onClick={this.setTheme}></div>\n        </div>\n        <div className=\"box-buttons\">\n          <ButtonSmall\n            name=\"btnRewind\"\n            alignRight={false}\n            theme={this.state.theme}\n          />\n          <ButtonSmall name=\"btnSkip\" alignRight={false} theme={this.state.theme} />\n          <ButtonSmall name=\"btnExit\" alignRight={true} theme={this.state.theme} />\n        </div>\n      </div>\n    );\n  }\n}\n\nclass ButtonSmall extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      theme: 'light',\n      clicked: false\n    }\n  }\n  static getDerivedStateFromProps(props, state) {\n    return {\n      theme: props.theme,\n      clicked: props.clicked\n    };\n  }\n  render() {\n    return (\n      <button\n        id={this.props.name}\n        className={\n          \"button-small theme-\"+\n          this.state.theme+\n          (this.props.alignRight ? ' align-right' : '')\n        }\n      >\n      </button>\n    );\n  }\n}\n\n\nfunction App() {\n  initAudio();\n  initData();\n  const element = <Baseplate\n    name={currentData.name}\n    message={currentData.message}\n    displayMessage={currentData.displayMessage}\n    displayOnly={currentData.displayOnly}\n    hasImage={currentData.hasImage}\n    epd={currentData.epd}\n    answerEntity={currentData.answerEntity}\n    maxTimeout={currentData.maxTimeout}\n  />;\n  return(element);\n}\nexport default App;\n"]},"metadata":{},"sourceType":"module"}